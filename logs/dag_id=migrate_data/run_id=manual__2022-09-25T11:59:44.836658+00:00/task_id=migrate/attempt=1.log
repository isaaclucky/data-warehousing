[2022-09-25T11:59:48.649+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: migrate_data.migrate manual__2022-09-25T11:59:44.836658+00:00 [queued]>
[2022-09-25T11:59:48.662+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: migrate_data.migrate manual__2022-09-25T11:59:44.836658+00:00 [queued]>
[2022-09-25T11:59:48.663+0000] {taskinstance.py:1362} INFO - 
--------------------------------------------------------------------------------
[2022-09-25T11:59:48.663+0000] {taskinstance.py:1363} INFO - Starting attempt 1 of 3
[2022-09-25T11:59:48.663+0000] {taskinstance.py:1364} INFO - 
--------------------------------------------------------------------------------
[2022-09-25T11:59:48.677+0000] {taskinstance.py:1383} INFO - Executing <Task(PythonOperator): migrate> on 2022-09-25 11:59:44.836658+00:00
[2022-09-25T11:59:48.683+0000] {standard_task_runner.py:54} INFO - Started process 2940 to run task
[2022-09-25T11:59:48.685+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'migrate_data', 'migrate', 'manual__2022-09-25T11:59:44.836658+00:00', '--job-id', '56', '--raw', '--subdir', 'DAGS_FOLDER/migrate.py', '--cfg-path', '/tmp/tmp_4o85t4d']
[2022-09-25T11:59:48.686+0000] {standard_task_runner.py:83} INFO - Job 56: Subtask migrate
[2022-09-25T11:59:48.686+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/***/dags/migrate.py
[2022-09-25T11:59:49.137+0000] {task_command.py:384} INFO - Running <TaskInstance: migrate_data.migrate manual__2022-09-25T11:59:44.836658+00:00 [running]> on host 5aeb3e9582c2
[2022-09-25T11:59:49.278+0000] {taskinstance.py:1592} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=isaaclucky88@gmail.com
AIRFLOW_CTX_DAG_OWNER=yishaktadele
AIRFLOW_CTX_DAG_ID=migrate_data
AIRFLOW_CTX_TASK_ID=migrate
AIRFLOW_CTX_EXECUTION_DATE=2022-09-25T11:59:44.836658+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-09-25T11:59:44.836658+00:00
[2022-09-25T11:59:49.280+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/pandas/util/_decorators.py:311: ParserWarning: Falling back to the 'python' engine because the 'c' engine does not support regex separators (separators > 1 char and different from '\s+' are interpreted as regex); you can avoid this warning by specifying engine='python'.
  return func(*args, **kwargs)

[2022-09-25T12:00:23.779+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/pandas/io/parsers/readers.py:586: ParserWarning: Length of header or names does not match length of data. This leads to a loss of data with index_col=False.
  return _read(filepath_or_buffer, kwds)

[2022-09-25T12:00:46.961+0000] {logging_mixin.py:117} INFO - <<<<<<<<<<start migrating data>>>>>>>>>>>>>>
[2022-09-25T12:00:46.988+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:46,988 INFO sqlalchemy.engine.Engine select pg_catalog.version()
[2022-09-25T12:00:46.988+0000] {log.py:117} INFO - select pg_catalog.version()
[2022-09-25T12:00:46.990+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:46,989 INFO sqlalchemy.engine.Engine [raw sql] {}
[2022-09-25T12:00:46.989+0000] {log.py:117} INFO - [raw sql] {}
[2022-09-25T12:00:46.991+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:46,991 INFO sqlalchemy.engine.Engine select current_schema()
[2022-09-25T12:00:46.991+0000] {log.py:117} INFO - select current_schema()
[2022-09-25T12:00:46.992+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:46,992 INFO sqlalchemy.engine.Engine [raw sql] {}
[2022-09-25T12:00:46.992+0000] {log.py:117} INFO - [raw sql] {}
[2022-09-25T12:00:46.993+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:46,993 INFO sqlalchemy.engine.Engine show standard_conforming_strings
[2022-09-25T12:00:46.993+0000] {log.py:117} INFO - show standard_conforming_strings
[2022-09-25T12:00:46.994+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:46,993 INFO sqlalchemy.engine.Engine [raw sql] {}
[2022-09-25T12:00:46.993+0000] {log.py:117} INFO - [raw sql] {}
[2022-09-25T12:00:46.998+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:46,998 INFO sqlalchemy.engine.Engine BEGIN (implicit)
[2022-09-25T12:00:46.998+0000] {log.py:117} INFO - BEGIN (implicit)
[2022-09-25T12:00:46.998+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:46,998 INFO sqlalchemy.engine.Engine select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s
[2022-09-25T12:00:46.998+0000] {log.py:117} INFO - select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s
[2022-09-25T12:00:46.999+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:46,999 INFO sqlalchemy.engine.Engine [generated in 0.00108s] {'name': 'traffic_data'}
[2022-09-25T12:00:46.999+0000] {log.py:117} INFO - [generated in 0.00108s] {'name': 'traffic_data'}
[2022-09-25T12:00:47.001+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,000 INFO sqlalchemy.engine.Engine ROLLBACK
[2022-09-25T12:00:47.000+0000] {log.py:117} INFO - ROLLBACK
[2022-09-25T12:00:47.003+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,003 INFO sqlalchemy.engine.Engine BEGIN (implicit)
[2022-09-25T12:00:47.003+0000] {log.py:117} INFO - BEGIN (implicit)
[2022-09-25T12:00:47.003+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,003 INFO sqlalchemy.engine.Engine select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s
[2022-09-25T12:00:47.003+0000] {log.py:117} INFO - select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s
[2022-09-25T12:00:47.004+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,004 INFO sqlalchemy.engine.Engine [cached since 0.006386s ago] {'name': 'traffic_data'}
[2022-09-25T12:00:47.004+0000] {log.py:117} INFO - [cached since 0.006386s ago] {'name': 'traffic_data'}
[2022-09-25T12:00:47.006+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,006 INFO sqlalchemy.engine.Engine ROLLBACK
[2022-09-25T12:00:47.006+0000] {log.py:117} INFO - ROLLBACK
[2022-09-25T12:00:47.011+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,011 INFO sqlalchemy.engine.Engine BEGIN (implicit)
[2022-09-25T12:00:47.011+0000] {log.py:117} INFO - BEGIN (implicit)
[2022-09-25T12:00:47.013+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,013 INFO sqlalchemy.engine.Engine SELECT c.relname FROM pg_class c JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname = %(schema)s AND c.relkind in ('r', 'p')
[2022-09-25T12:00:47.013+0000] {log.py:117} INFO - SELECT c.relname FROM pg_class c JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname = %(schema)s AND c.relkind in ('r', 'p')
[2022-09-25T12:00:47.013+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,013 INFO sqlalchemy.engine.Engine [generated in 0.00307s] {'schema': 'public'}
[2022-09-25T12:00:47.013+0000] {log.py:117} INFO - [generated in 0.00307s] {'schema': 'public'}
[2022-09-25T12:00:47.018+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,018 INFO sqlalchemy.engine.Engine 
            SELECT c.oid
            FROM pg_catalog.pg_class c
            LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
            WHERE (pg_catalog.pg_table_is_visible(c.oid))
            AND c.relname = %(table_name)s AND c.relkind in
            ('r', 'v', 'm', 'f', 'p')
[2022-09-25T12:00:47.018+0000] {log.py:117} INFO - 
            SELECT c.oid
            FROM pg_catalog.pg_class c
            LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
            WHERE (pg_catalog.pg_table_is_visible(c.oid))
            AND c.relname = %(table_name)s AND c.relkind in
            ('r', 'v', 'm', 'f', 'p')
        
[2022-09-25T12:00:47.019+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,019 INFO sqlalchemy.engine.Engine [generated in 0.00152s] {'table_name': 'traffic_data'}
[2022-09-25T12:00:47.019+0000] {log.py:117} INFO - [generated in 0.00152s] {'table_name': 'traffic_data'}
[2022-09-25T12:00:47.023+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,023 INFO sqlalchemy.engine.Engine 
            SELECT a.attname,
              pg_catalog.format_type(a.atttypid, a.atttypmod),
              (
                SELECT pg_catalog.pg_get_expr(d.adbin, d.adrelid)
                FROM pg_catalog.pg_attrdef d
                WHERE d.adrelid = a.attrelid AND d.adnum = a.attnum
                AND a.atthasdef
              ) AS DEFAULT,
              a.attnotnull,
              a.attrelid as table_oid,
              pgd.description as comment,
              a.attgenerated as generated,
                              (SELECT json_build_object(
                    'always', a.attidentity = 'a',
                    'start', s.seqstart,
                    'increment', s.seqincrement,
                    'minvalue', s.seqmin,
                    'maxvalue', s.seqmax,
                    'cache', s.seqcache,
                    'cycle', s.seqcycle)
                FROM pg_catalog.pg_sequence s
                JOIN pg_catalog.pg_class c on s.seqrelid = c."oid"
                WHERE c.relkind = 'S'
                AND a.attidentity != ''
                AND s.seqrelid = pg_catalog.pg_get_serial_sequence(
                    a.attrelid::regclass::text, a.attname
                )::regclass::oid
                ) as identity_options                
            FROM pg_catalog.pg_attribute a
            LEFT JOIN pg_catalog.pg_description pgd ON (
                pgd.objoid = a.attrelid AND pgd.objsubid = a.attnum)
            WHERE a.attrelid = %(table_oid)s
            AND a.attnum > 0 AND NOT a.attisdropped
            ORDER BY a.attnum
[2022-09-25T12:00:47.023+0000] {log.py:117} INFO - 
            SELECT a.attname,
              pg_catalog.format_type(a.atttypid, a.atttypmod),
              (
                SELECT pg_catalog.pg_get_expr(d.adbin, d.adrelid)
                FROM pg_catalog.pg_attrdef d
                WHERE d.adrelid = a.attrelid AND d.adnum = a.attnum
                AND a.atthasdef
              ) AS DEFAULT,
              a.attnotnull,
              a.attrelid as table_oid,
              pgd.description as comment,
              a.attgenerated as generated,
                              (SELECT json_build_object(
                    'always', a.attidentity = 'a',
                    'start', s.seqstart,
                    'increment', s.seqincrement,
                    'minvalue', s.seqmin,
                    'maxvalue', s.seqmax,
                    'cache', s.seqcache,
                    'cycle', s.seqcycle)
                FROM pg_catalog.pg_sequence s
                JOIN pg_catalog.pg_class c on s.seqrelid = c."oid"
                WHERE c.relkind = 'S'
                AND a.attidentity != ''
                AND s.seqrelid = pg_catalog.pg_get_serial_sequence(
                    a.attrelid::regclass::text, a.attname
                )::regclass::oid
                ) as identity_options                
            FROM pg_catalog.pg_attribute a
            LEFT JOIN pg_catalog.pg_description pgd ON (
                pgd.objoid = a.attrelid AND pgd.objsubid = a.attnum)
            WHERE a.attrelid = %(table_oid)s
            AND a.attnum > 0 AND NOT a.attisdropped
            ORDER BY a.attnum
        
[2022-09-25T12:00:47.024+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,023 INFO sqlalchemy.engine.Engine [generated in 0.00098s] {'table_oid': 24577}
[2022-09-25T12:00:47.023+0000] {log.py:117} INFO - [generated in 0.00098s] {'table_oid': 24577}
[2022-09-25T12:00:47.028+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,028 INFO sqlalchemy.engine.Engine 
            SELECT t.typname as "name",
               pg_catalog.format_type(t.typbasetype, t.typtypmod) as "attype",
               not t.typnotnull as "nullable",
               t.typdefault as "default",
               pg_catalog.pg_type_is_visible(t.oid) as "visible",
               n.nspname as "schema"
            FROM pg_catalog.pg_type t
               LEFT JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace
            WHERE t.typtype = 'd'
[2022-09-25T12:00:47.028+0000] {log.py:117} INFO - 
            SELECT t.typname as "name",
               pg_catalog.format_type(t.typbasetype, t.typtypmod) as "attype",
               not t.typnotnull as "nullable",
               t.typdefault as "default",
               pg_catalog.pg_type_is_visible(t.oid) as "visible",
               n.nspname as "schema"
            FROM pg_catalog.pg_type t
               LEFT JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace
            WHERE t.typtype = 'd'
        
[2022-09-25T12:00:47.029+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,029 INFO sqlalchemy.engine.Engine [generated in 0.00177s] {}
[2022-09-25T12:00:47.029+0000] {log.py:117} INFO - [generated in 0.00177s] {}
[2022-09-25T12:00:47.032+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,032 INFO sqlalchemy.engine.Engine 
            SELECT t.typname as "name",
               -- no enum defaults in 8.4 at least
               -- t.typdefault as "default",
               pg_catalog.pg_type_is_visible(t.oid) as "visible",
               n.nspname as "schema",
               e.enumlabel as "label"
            FROM pg_catalog.pg_type t
                 LEFT JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace
                 LEFT JOIN pg_catalog.pg_enum e ON t.oid = e.enumtypid
            WHERE t.typtype = 'e'
        ORDER BY "schema", "name", e.oid
[2022-09-25T12:00:47.032+0000] {log.py:117} INFO - 
            SELECT t.typname as "name",
               -- no enum defaults in 8.4 at least
               -- t.typdefault as "default",
               pg_catalog.pg_type_is_visible(t.oid) as "visible",
               n.nspname as "schema",
               e.enumlabel as "label"
            FROM pg_catalog.pg_type t
                 LEFT JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace
                 LEFT JOIN pg_catalog.pg_enum e ON t.oid = e.enumtypid
            WHERE t.typtype = 'e'
        ORDER BY "schema", "name", e.oid
[2022-09-25T12:00:47.033+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,033 INFO sqlalchemy.engine.Engine [generated in 0.00051s] {}
[2022-09-25T12:00:47.033+0000] {log.py:117} INFO - [generated in 0.00051s] {}
[2022-09-25T12:00:47.037+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,037 INFO sqlalchemy.engine.Engine 
                SELECT a.attname
                FROM pg_attribute a JOIN (
                    SELECT unnest(ix.indkey) attnum,
                           generate_subscripts(ix.indkey, 1) ord
                    FROM pg_index ix
                    WHERE ix.indrelid = %(table_oid)s AND ix.indisprimary
                    ) k ON a.attnum=k.attnum
                WHERE a.attrelid = %(table_oid)s
                ORDER BY k.ord
[2022-09-25T12:00:47.037+0000] {log.py:117} INFO - 
                SELECT a.attname
                FROM pg_attribute a JOIN (
                    SELECT unnest(ix.indkey) attnum,
                           generate_subscripts(ix.indkey, 1) ord
                    FROM pg_index ix
                    WHERE ix.indrelid = %(table_oid)s AND ix.indisprimary
                    ) k ON a.attnum=k.attnum
                WHERE a.attrelid = %(table_oid)s
                ORDER BY k.ord
            
[2022-09-25T12:00:47.038+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,038 INFO sqlalchemy.engine.Engine [generated in 0.00063s] {'table_oid': 24577}
[2022-09-25T12:00:47.038+0000] {log.py:117} INFO - [generated in 0.00063s] {'table_oid': 24577}
[2022-09-25T12:00:47.040+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,040 INFO sqlalchemy.engine.Engine 
        SELECT conname
           FROM  pg_catalog.pg_constraint r
           WHERE r.conrelid = %(table_oid)s AND r.contype = 'p'
           ORDER BY 1
[2022-09-25T12:00:47.040+0000] {log.py:117} INFO - 
        SELECT conname
           FROM  pg_catalog.pg_constraint r
           WHERE r.conrelid = %(table_oid)s AND r.contype = 'p'
           ORDER BY 1
        
[2022-09-25T12:00:47.041+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,041 INFO sqlalchemy.engine.Engine [generated in 0.00093s] {'table_oid': 24577}
[2022-09-25T12:00:47.041+0000] {log.py:117} INFO - [generated in 0.00093s] {'table_oid': 24577}
[2022-09-25T12:00:47.047+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,047 INFO sqlalchemy.engine.Engine 
          SELECT r.conname,
                pg_catalog.pg_get_constraintdef(r.oid, true) as condef,
                n.nspname as conschema
          FROM  pg_catalog.pg_constraint r,
                pg_namespace n,
                pg_class c

          WHERE r.conrelid = %(table)s AND
                r.contype = 'f' AND
                c.oid = confrelid AND
                n.oid = c.relnamespace
          ORDER BY 1
[2022-09-25T12:00:47.047+0000] {log.py:117} INFO - 
          SELECT r.conname,
                pg_catalog.pg_get_constraintdef(r.oid, true) as condef,
                n.nspname as conschema
          FROM  pg_catalog.pg_constraint r,
                pg_namespace n,
                pg_class c

          WHERE r.conrelid = %(table)s AND
                r.contype = 'f' AND
                c.oid = confrelid AND
                n.oid = c.relnamespace
          ORDER BY 1
        
[2022-09-25T12:00:47.049+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,048 INFO sqlalchemy.engine.Engine [generated in 0.00160s] {'table': 24577}
[2022-09-25T12:00:47.048+0000] {log.py:117} INFO - [generated in 0.00160s] {'table': 24577}
[2022-09-25T12:00:47.051+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,051 INFO sqlalchemy.engine.Engine 
              SELECT
                  i.relname as relname,
                  ix.indisunique, ix.indexprs,
                  a.attname, a.attnum, c.conrelid, ix.indkey::varchar,
                  ix.indoption::varchar, i.reloptions, am.amname,
                  pg_get_expr(ix.indpred, ix.indrelid),
                  ix.indnkeyatts as indnkeyatts
              FROM
                  pg_class t
                        join pg_index ix on t.oid = ix.indrelid
                        join pg_class i on i.oid = ix.indexrelid
                        left outer join
                            pg_attribute a
                            on t.oid = a.attrelid and a.attnum = ANY(ix.indkey)
                        left outer join
                            pg_constraint c
                            on (ix.indrelid = c.conrelid and
                                ix.indexrelid = c.conindid and
                                c.contype in ('p', 'u', 'x'))
                        left outer join
                            pg_am am
                            on i.relam = am.oid
              WHERE
                  t.relkind IN ('r', 'v', 'f', 'm', 'p')
                  and t.oid = %(table_oid)s
                  and ix.indisprimary = 'f'
              ORDER BY
                  t.relname,
                  i.relname
[2022-09-25T12:00:47.051+0000] {log.py:117} INFO - 
              SELECT
                  i.relname as relname,
                  ix.indisunique, ix.indexprs,
                  a.attname, a.attnum, c.conrelid, ix.indkey::varchar,
                  ix.indoption::varchar, i.reloptions, am.amname,
                  pg_get_expr(ix.indpred, ix.indrelid),
                  ix.indnkeyatts as indnkeyatts
              FROM
                  pg_class t
                        join pg_index ix on t.oid = ix.indrelid
                        join pg_class i on i.oid = ix.indexrelid
                        left outer join
                            pg_attribute a
                            on t.oid = a.attrelid and a.attnum = ANY(ix.indkey)
                        left outer join
                            pg_constraint c
                            on (ix.indrelid = c.conrelid and
                                ix.indexrelid = c.conindid and
                                c.contype in ('p', 'u', 'x'))
                        left outer join
                            pg_am am
                            on i.relam = am.oid
              WHERE
                  t.relkind IN ('r', 'v', 'f', 'm', 'p')
                  and t.oid = %(table_oid)s
                  and ix.indisprimary = 'f'
              ORDER BY
                  t.relname,
                  i.relname
            
[2022-09-25T12:00:47.052+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,052 INFO sqlalchemy.engine.Engine [generated in 0.00097s] {'table_oid': 24577}
[2022-09-25T12:00:47.052+0000] {log.py:117} INFO - [generated in 0.00097s] {'table_oid': 24577}
[2022-09-25T12:00:47.059+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,059 INFO sqlalchemy.engine.Engine 
            SELECT
                cons.conname as name,
                cons.conkey as key,
                a.attnum as col_num,
                a.attname as col_name
            FROM
                pg_catalog.pg_constraint cons
                join pg_attribute a
                  on cons.conrelid = a.attrelid AND
                    a.attnum = ANY(cons.conkey)
            WHERE
                cons.conrelid = %(table_oid)s AND
                cons.contype = 'u'
[2022-09-25T12:00:47.059+0000] {log.py:117} INFO - 
            SELECT
                cons.conname as name,
                cons.conkey as key,
                a.attnum as col_num,
                a.attname as col_name
            FROM
                pg_catalog.pg_constraint cons
                join pg_attribute a
                  on cons.conrelid = a.attrelid AND
                    a.attnum = ANY(cons.conkey)
            WHERE
                cons.conrelid = %(table_oid)s AND
                cons.contype = 'u'
        
[2022-09-25T12:00:47.060+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,060 INFO sqlalchemy.engine.Engine [generated in 0.00057s] {'table_oid': 24577}
[2022-09-25T12:00:47.060+0000] {log.py:117} INFO - [generated in 0.00057s] {'table_oid': 24577}
[2022-09-25T12:00:47.064+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,064 INFO sqlalchemy.engine.Engine 
            SELECT
                cons.conname as name,
                pg_get_constraintdef(cons.oid) as src
            FROM
                pg_catalog.pg_constraint cons
            WHERE
                cons.conrelid = %(table_oid)s AND
                cons.contype = 'c'
[2022-09-25T12:00:47.064+0000] {log.py:117} INFO - 
            SELECT
                cons.conname as name,
                pg_get_constraintdef(cons.oid) as src
            FROM
                pg_catalog.pg_constraint cons
            WHERE
                cons.conrelid = %(table_oid)s AND
                cons.contype = 'c'
        
[2022-09-25T12:00:47.065+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,065 INFO sqlalchemy.engine.Engine [generated in 0.00067s] {'table_oid': 24577}
[2022-09-25T12:00:47.065+0000] {log.py:117} INFO - [generated in 0.00067s] {'table_oid': 24577}
[2022-09-25T12:00:47.067+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,066 INFO sqlalchemy.engine.Engine 
            SELECT
                pgd.description as table_comment
            FROM
                pg_catalog.pg_description pgd
            WHERE
                pgd.objsubid = 0 AND
                pgd.objoid = %(table_oid)s
[2022-09-25T12:00:47.066+0000] {log.py:117} INFO - 
            SELECT
                pgd.description as table_comment
            FROM
                pg_catalog.pg_description pgd
            WHERE
                pgd.objsubid = 0 AND
                pgd.objoid = %(table_oid)s
        
[2022-09-25T12:00:47.067+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,067 INFO sqlalchemy.engine.Engine [generated in 0.00063s] {'table_oid': 24577}
[2022-09-25T12:00:47.067+0000] {log.py:117} INFO - [generated in 0.00063s] {'table_oid': 24577}
[2022-09-25T12:00:47.069+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,069 INFO sqlalchemy.engine.Engine ROLLBACK
[2022-09-25T12:00:47.069+0000] {log.py:117} INFO - ROLLBACK
[2022-09-25T12:00:47.070+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,070 INFO sqlalchemy.engine.Engine BEGIN (implicit)
[2022-09-25T12:00:47.070+0000] {log.py:117} INFO - BEGIN (implicit)
[2022-09-25T12:00:47.070+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,070 INFO sqlalchemy.engine.Engine 
DROP TABLE traffic_data
[2022-09-25T12:00:47.070+0000] {log.py:117} INFO - 
DROP TABLE traffic_data
[2022-09-25T12:00:47.071+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,071 INFO sqlalchemy.engine.Engine [no key 0.00031s] {}
[2022-09-25T12:00:47.071+0000] {log.py:117} INFO - [no key 0.00031s] {}
[2022-09-25T12:00:47.074+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,074 INFO sqlalchemy.engine.Engine COMMIT
[2022-09-25T12:00:47.074+0000] {log.py:117} INFO - COMMIT
[2022-09-25T12:00:47.081+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,080 INFO sqlalchemy.engine.Engine BEGIN (implicit)
[2022-09-25T12:00:47.080+0000] {log.py:117} INFO - BEGIN (implicit)
[2022-09-25T12:00:47.085+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,084 INFO sqlalchemy.engine.Engine 
CREATE TABLE traffic_data (
	id BIGINT, 
	track_id BIGINT, 
	" type" TEXT, 
	" traveled_d" FLOAT(53), 
	" avg_speed" FLOAT(53), 
	" lat" FLOAT(53), 
	" lon" FLOAT(53), 
	" speed" FLOAT(53), 
	" lon_acc" FLOAT(53), 
	" lat_acc" FLOAT(53), 
	" time" FLOAT(53)
)
[2022-09-25T12:00:47.084+0000] {log.py:117} INFO - 
CREATE TABLE traffic_data (
	id BIGINT, 
	track_id BIGINT, 
	" type" TEXT, 
	" traveled_d" FLOAT(53), 
	" avg_speed" FLOAT(53), 
	" lat" FLOAT(53), 
	" lon" FLOAT(53), 
	" speed" FLOAT(53), 
	" lon_acc" FLOAT(53), 
	" lat_acc" FLOAT(53), 
	" time" FLOAT(53)
)


[2022-09-25T12:00:47.085+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,085 INFO sqlalchemy.engine.Engine [no key 0.00154s] {}
[2022-09-25T12:00:47.085+0000] {log.py:117} INFO - [no key 0.00154s] {}
[2022-09-25T12:00:47.096+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,096 INFO sqlalchemy.engine.Engine CREATE INDEX ix_traffic_data_id ON traffic_data (id)
[2022-09-25T12:00:47.096+0000] {log.py:117} INFO - CREATE INDEX ix_traffic_data_id ON traffic_data (id)
[2022-09-25T12:00:47.097+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,097 INFO sqlalchemy.engine.Engine [no key 0.00127s] {}
[2022-09-25T12:00:47.097+0000] {log.py:117} INFO - [no key 0.00127s] {}
[2022-09-25T12:00:47.100+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,100 INFO sqlalchemy.engine.Engine COMMIT
[2022-09-25T12:00:47.100+0000] {log.py:117} INFO - COMMIT
[2022-09-25T12:00:47.115+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,115 INFO sqlalchemy.engine.Engine BEGIN (implicit)
[2022-09-25T12:00:47.115+0000] {log.py:117} INFO - BEGIN (implicit)
[2022-09-25T12:00:47.146+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,145 INFO sqlalchemy.engine.Engine INSERT INTO traffic_data (id, track_id, " type", " traveled_d", " avg_speed", " lat", " lon", " speed", " lon_acc", " lat_acc", " time") VALUES (%(id)s, %(track_id)s, %( type)s, %( traveled_d)s, %( avg_speed)s, %( lat)s, %( lon)s, %( speed)s, %( lon_acc)s, %( lat_acc)s, %( time)s)
[2022-09-25T12:00:47.145+0000] {log.py:117} INFO - INSERT INTO traffic_data (id, track_id, " type", " traveled_d", " avg_speed", " lat", " lon", " speed", " lon_acc", " lat_acc", " time") VALUES (%(id)s, %(track_id)s, %( type)s, %( traveled_d)s, %( avg_speed)s, %( lat)s, %( lon)s, %( speed)s, %( lon_acc)s, %( lat_acc)s, %( time)s)
[2022-09-25T12:00:47.147+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,147 INFO sqlalchemy.engine.Engine [generated in 0.02628s] ({'id': 0, 'track_id': 1, ' type': ' Car', ' traveled_d': 48.85, ' avg_speed': 9.770344, ' lat': 37.977391, ' lon': 23.737688, ' speed': 4.9178, ' lon_acc': 0.0518, ' lat_acc': -0.0299, ' time': 0.0}, {'id': 1, 'track_id': 2, ' type': ' Motorcycle', ' traveled_d': 98.09, ' avg_speed': 19.839417, ' lat': 37.977642, ' lon': 23.7374, ' speed': 16.9759, ' lon_acc': -0.0361, ' lat_acc': -0.0228, ' time': 0.0}, {'id': 2, 'track_id': 3, ' type': ' Motorcycle', ' traveled_d': 63.8, ' avg_speed': 18.228752, ' lat': 37.977997, ' lon': 23.737264, ' speed': 20.1906, ' lon_acc': -0.0795, ' lat_acc': -0.3395, ' time': 0.0}, {'id': 3, 'track_id': 4, ' type': ' Motorcycle', ' traveled_d': 145.72, ' avg_speed': 26.229014, ' lat': 37.978135, ' lon': 23.737072, ' speed': 2.7555, ' lon_acc': -0.0302, ' lat_acc': 0.0948, ' time': 0.0}, {'id': 4, 'track_id': 5, ' type': ' Motorcycle', ' traveled_d': 138.01, ' avg_speed': 24.841425, ' lat': 37.978134, ' lon': 23.737103, ' speed': 0.0, ' lon_acc': 0.0, ' lat_acc': 0.0, ' time': 0.0}, {'id': 5, 'track_id': 6, ' type': ' Medium Vehicle', ' traveled_d': 159.97, ' avg_speed': 17.451502, ' lat': 37.978152, ' lon': 23.73712, ' speed': 0.0, ' lon_acc': 0.0, ' lat_acc': 0.0, ' time': 0.0}, {'id': 6, 'track_id': 7, ' type': ' Motorcycle', ' traveled_d': 153.91, ' avg_speed': 22.895895, ' lat': 37.978145, ' lon': 23.737161, ' speed': 0.0, ' lon_acc': 0.0, ' lat_acc': 0.0, ' time': 0.0}, {'id': 7, 'track_id': 8, ' type': ' Car', ' traveled_d': 158.21, ' avg_speed': 21.739084, ' lat': 37.97823, ' lon': 23.737089, ' speed': 0.0, ' lon_acc': 0.0, ' lat_acc': 0.0, ' time': 0.0}  ... displaying 10 of 922 total bound parameter sets ...  {'id': 920, 'track_id': 921, ' type': ' Motorcycle', ' traveled_d': 46.68, ' avg_speed': 30.007124, ' lat': 37.98002, ' lon': 23.736861, ' speed': 32.3581, ' lon_acc': -0.0493, ' lat_acc': -0.105, ' time': 813.2}, {'id': 921, 'track_id': 922, ' type': ' Car', ' traveled_d': 35.0, ' avg_speed': 23.335533, ' lat': 37.978428, ' lon': 23.735538, ' speed': 24.1909, ' lon_acc': -0.0077, ' lat_acc': -0.066, ' time': 813.4})
[2022-09-25T12:00:47.147+0000] {log.py:117} INFO - [generated in 0.02628s] ({'id': 0, 'track_id': 1, ' type': ' Car', ' traveled_d': 48.85, ' avg_speed': 9.770344, ' lat': 37.977391, ' lon': 23.737688, ' speed': 4.9178, ' lon_acc': 0.0518, ' lat_acc': -0.0299, ' time': 0.0}, {'id': 1, 'track_id': 2, ' type': ' Motorcycle', ' traveled_d': 98.09, ' avg_speed': 19.839417, ' lat': 37.977642, ' lon': 23.7374, ' speed': 16.9759, ' lon_acc': -0.0361, ' lat_acc': -0.0228, ' time': 0.0}, {'id': 2, 'track_id': 3, ' type': ' Motorcycle', ' traveled_d': 63.8, ' avg_speed': 18.228752, ' lat': 37.977997, ' lon': 23.737264, ' speed': 20.1906, ' lon_acc': -0.0795, ' lat_acc': -0.3395, ' time': 0.0}, {'id': 3, 'track_id': 4, ' type': ' Motorcycle', ' traveled_d': 145.72, ' avg_speed': 26.229014, ' lat': 37.978135, ' lon': 23.737072, ' speed': 2.7555, ' lon_acc': -0.0302, ' lat_acc': 0.0948, ' time': 0.0}, {'id': 4, 'track_id': 5, ' type': ' Motorcycle', ' traveled_d': 138.01, ' avg_speed': 24.841425, ' lat': 37.978134, ' lon': 23.737103, ' speed': 0.0, ' lon_acc': 0.0, ' lat_acc': 0.0, ' time': 0.0}, {'id': 5, 'track_id': 6, ' type': ' Medium Vehicle', ' traveled_d': 159.97, ' avg_speed': 17.451502, ' lat': 37.978152, ' lon': 23.73712, ' speed': 0.0, ' lon_acc': 0.0, ' lat_acc': 0.0, ' time': 0.0}, {'id': 6, 'track_id': 7, ' type': ' Motorcycle', ' traveled_d': 153.91, ' avg_speed': 22.895895, ' lat': 37.978145, ' lon': 23.737161, ' speed': 0.0, ' lon_acc': 0.0, ' lat_acc': 0.0, ' time': 0.0}, {'id': 7, 'track_id': 8, ' type': ' Car', ' traveled_d': 158.21, ' avg_speed': 21.739084, ' lat': 37.97823, ' lon': 23.737089, ' speed': 0.0, ' lon_acc': 0.0, ' lat_acc': 0.0, ' time': 0.0}  ... displaying 10 of 922 total bound parameter sets ...  {'id': 920, 'track_id': 921, ' type': ' Motorcycle', ' traveled_d': 46.68, ' avg_speed': 30.007124, ' lat': 37.98002, ' lon': 23.736861, ' speed': 32.3581, ' lon_acc': -0.0493, ' lat_acc': -0.105, ' time': 813.2}, {'id': 921, 'track_id': 922, ' type': ' Car', ' traveled_d': 35.0, ' avg_speed': 23.335533, ' lat': 37.978428, ' lon': 23.735538, ' speed': 24.1909, ' lon_acc': -0.0077, ' lat_acc': -0.066, ' time': 813.4})
[2022-09-25T12:00:47.225+0000] {logging_mixin.py:117} INFO - 2022-09-25 12:00:47,225 INFO sqlalchemy.engine.Engine COMMIT
[2022-09-25T12:00:47.225+0000] {log.py:117} INFO - COMMIT
[2022-09-25T12:00:47.228+0000] {logging_mixin.py:117} INFO - <<<<<<<<<<<<<<<<<<<completed>>>>>>>>>>>>>>>>
[2022-09-25T12:00:47.229+0000] {python.py:177} INFO - Done. Returned value was: None
[2022-09-25T12:00:47.254+0000] {taskinstance.py:1406} INFO - Marking task as SUCCESS. dag_id=migrate_data, task_id=migrate, execution_date=20220925T115944, start_date=20220925T115948, end_date=20220925T120047
[2022-09-25T12:00:47.365+0000] {local_task_job.py:164} INFO - Task exited with return code 0
[2022-09-25T12:00:47.409+0000] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
